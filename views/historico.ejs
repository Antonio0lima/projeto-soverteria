<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Histórico de Pedidos</title>
  
  <!-- Fontes e CSS -->
  <link href="https://fonts.googleapis.com/css2?family=Inconsolata:wght@400;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="/css/navbar.css">
  <link rel="stylesheet" href="/css/historico.css"> <!-- Novo arquivo CSS -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>

<body> 
  <!-- Lógica da Navbar (Mantida) -->
  <% if (usuario && usuario.tipo === "admin") { %>
    <%- include("partials/navbar/navbar-adm") %>
  <% } else { %>
    <%- include("partials/navbar/navbar") %>
  <% } %>

  <div class="container-historico">
    
    <header class="header-historico">
      <h1>Meus Pedidos</h1>
      <!-- Filtros decorativos (laranjas na imagem) -->
      <div class="filtros">
        <span class="filtro"></span>
        <span class="filtro"></span>
        <span class="filtro"></span>
      </div>
    </header>

    <!-- Grid Principal -->
    <div class="grid-pedidos">

      <% if (pedidos.length > 0) { %>
        <!-- QUADRADO A: O Último Pedido (Destaque) -->
        <% const ultimo = pedidos[0]; %>
        <div class="card destaque">
          <div class="card-header">
            <span class="tag-status <%= ultimo.status %>"><%= ultimo.status %></span>
            <span class="data"><%= ultimo.data_pedido %></span>
          </div>
          <div class="card-body">
            <h2>Pedido #<%= ultimo.id %></h2>
            <p class="produtos"><%= ultimo.produtos || ultimo.pedido %></p>
            <p class="valor">R$ <%= ultimo.valor %></p>
          </div>
          <div class="card-footer">
            <button class="btn-detalhes">Ver detalhes</button>
          </div>
        </div>
      <% } else { %>
        <div class="card destaque">
          <p>Você ainda não fez nenhum pedido.</p>
        </div>
      <% } %>

      <!-- QUADRADO B: Espaço Vazio / Ação -->
      <div class="card vazio">
        <div class="conteudo-vazio">
          <span>B</span>
          <p>Espaço reservado</p>
        </div>
      </div>

      <!-- QUADRADOS C: Histórico (Restante dos pedidos) -->
      <% for(let i = 1; i < pedidos.length; i++) { %>
        <% const p = pedidos[i]; %>
        <div class="card item-historico">
          <div class="card-header-mini">
            <span class="id">#<%= p.id %></span>
            <span class="data-mini"><%= p.data_pedido.split(' ')[0] %></span> <!-- Só a data -->
          </div>
          <div class="card-body-mini">
            <p class="resumo-prod"><%= p.produtos || p.pedido %></p>
            <strong class="valor-mini">R$ <%= p.valor %></strong>
          </div>
          <div class="card-status-mini">
            <span class="status-dot <%= p.status %>"></span> <%= p.status %>
          </div>
        </div>
      <% } %>

    </div>
  </div>

</body>
</html>